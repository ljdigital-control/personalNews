document.addEventListener("DOMContentLoaded",function(){function e(e,t){e.classList.add(t)}function t(e,t){e.classList.remove(t)}function n(e,t){window.scrollTo(e,t)}function o(e,t){var n=document.querySelector(e).getAttribute(t);return n}function l(){var t=document.getElementsByTagName("body")[0];e(t,"js")}function s(e){var t=document.getElementsByClassName(e);for(i=0;i<t.length;i++)t[i].onclick=function(e){var t=this.getAttribute("data-target");a(t,e)}}function a(n,o){var l=document.getElementById(n);l.classList.contains("js-visible")?(e(l,"js-hidden"),t(l,"js-visible"),t(x,"js-fx")):(t(l,"js-hidden"),e(l,"js-visible"),e(x,"js-fx")),v("content"),o.preventDefault()}function c(e,t,n){c=document.getElementById(e),c.classList.add("sticky"),stickyHeight=c.clientHeight+"px",document.getElementById(t).style.setProperty(n,stickyHeight)}function d(e){overlayElement=document.getElementById(e),overlayElement.style.top=stickyHeight}function m(n){var o="themeswitch.php?theme=",l=document.getElementsByTagName("html")[0];switchingElement=document.getElementById(n),switchingElement.onclick=function(){xmlhttp=new XMLHttpRequest,this.checked?(e(l,S),t(l,T),xmlhttp.open("GET",o+S,!0),xmlhttp.send(),localStorage.setItem("theme",S),console.log("localStorage Theme is: "+S)):(e(l,T),t(l,S),xmlhttp.open("GET","themeswitch.php?theme="+T,!0),xmlhttp.send(),localStorage.setItem("theme",T),console.log("localStorage Theme is: "+T))}}function r(e){elementContainer=document.getElementById(e),elementContainer.addEventListener("click",u,!1)}function u(e){e.target!==e.currentTarget&&(channelLink=e.target.getAttribute("href"),t(x,"js-fx"),g(channelLink),e.preventDefault()),e.stopPropagation()}function g(o){if(""===o){var l=localStorage.getItem("channel");if(null!==l)var o=l}document.getElementById(E).classList.remove("js-hidden"),renderFile="render-feeds.php",xmlhttp=new XMLHttpRequest,xmlhttp.open("GET",renderFile+o,!0),xmlhttp.send(),overlayContainer=document.getElementById("application-overlay"),e(overlayContainer,"js-hidden"),v("content"),xmlhttp.onreadystatechange=function(){4===xmlhttp.readyState&&xmlhttp.readyState&&(outputContainer=document.getElementById("content"),outputContainer.innerHTML=xmlhttp.response,n(0,0),document.getElementById(E).classList.add("js-hidden"),t(elementToFix,"js-fixed"),document.getElementById("application-overlay").classList.remove("js-visible"),localStorage.setItem("channel",o),lastSavedItemTs=localStorage.getItem("latestItemTs"),setTimeout(latestItemTs=h(),0),p(latestItemTs,lastSavedItemTs),y(j))}}function h(){return latestItemTs=o(j,"data-ts"),latestItemTs}function p(e,t){if(lastSavedItemTsId="#ts-"+t,lastSavedItemTsIdSet=document.querySelector(lastSavedItemTsId),console.log(lastSavedItemTsIdSet),null!==lastSavedItemTsIdSet)if(t&&e>t)updatedCount=o(lastSavedItemTsId,"data-count"),I(updatedCount),f(lastSavedItemTsId);else{document.getElementById("application-header").clientHeight;n(0,localStorage.getItem("offsetTop")),localStorage.setItem("offsetTop",0)}else I("error"),localStorage.setItem("latestItemTs",e)}function f(e){var t=document.querySelector(e).offsetTop,o=document.getElementById("application-header").clientHeight;n(0,t-o)}function y(e){var t=document.querySelectorAll(e);for(i=0;i<t.length;i++)t[i].onclick=function(e){localStorage.setItem("offsetTop",window.pageYOffset)}}function I(e){badge="#unread-items",badgeValue="#unread-items__count",e>0||"string"==typeof e?(document.querySelector(badge).classList.remove("js-hidden"),document.querySelector(badge).classList.add("js-show"),document.querySelector(badgeValue).innerText=e):(document.querySelector(badge).classList.remove("js-show"),document.querySelector(badge).classList.add("js-hide"))}function v(o){elementToFix=document.getElementById(o),scrollY=window.pageYOffset,elementToFix.classList.contains("js-fixed")?(t(elementToFix,"js-fixed"),elementToFix.style.top="",n(0,scrollYMem)):(e(elementToFix,"js-fixed"),elementToFix.style.top="-"+scrollY+"px",scrollYMem=scrollY)}var T="light",S="dark",E="application-loading",x=document.getElementsByTagName("body")[0],j="#feed-items li",w=localStorage.getItem("theme"),B=document.getElementsByTagName("html")[0];null!==w&&(t(B,T),t(B,S),e(B,w),w===T&&(document.getElementById("theme-switcher").checked=!1),w===S&&(document.getElementById("theme-switcher").checked=!0)),window.addEventListener("scroll",function(e){if(scrollDepth=window.pageYOffset,scrollDepth<=0){I();var t=h();localStorage.setItem("latestItemTs",t)}}),l(),g(""),c("application-header","content","margin-top"),m("theme-switcher"),s("js-overlay-toggle"),d("application-overlay"),r("channels")});