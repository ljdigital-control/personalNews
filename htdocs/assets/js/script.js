document.addEventListener("DOMContentLoaded",function(){function e(e,t){e.classList.add(t)}function t(e,t){e.classList.remove(t)}function n(e,t){window.scrollTo(e,t)}function o(e,t){var n=document.querySelector(e).getAttribute(t);return n}function l(){var t=document.getElementsByTagName("body")[0];e(t,"js")}function a(e){var t=document.getElementsByClassName(e);for(i=0;i<t.length;i++)t[i].onclick=function(e){var t=this.getAttribute("data-target");s(t,e)}}function s(n,o){var l=document.getElementById(n);l.classList.contains("js-visible")?(e(l,"js-hidden"),t(l,"js-visible"),t(S,"js-fx")):(t(l,"js-hidden"),e(l,"js-visible"),e(S,"js-fx")),v("content"),o.preventDefault()}function c(e,t,n){c=document.getElementById(e),c.classList.add("sticky"),stickyHeight=c.clientHeight+"px",document.getElementById(t).style.setProperty(n,stickyHeight)}function d(e){overlayElement=document.getElementById(e),overlayElement.style.top=stickyHeight}function m(n){var o="themeswitch.php?theme=",l=document.getElementsByTagName("html")[0];switchingElement=document.getElementById(n),switchingElement.onclick=function(){xmlhttp=new XMLHttpRequest,this.checked?(e(l,E),t(l,T),xmlhttp.open("GET",o+E,!0),xmlhttp.send(),localStorage.setItem("theme",E),console.log("localStorage Theme is: "+E)):(e(l,T),t(l,E),xmlhttp.open("GET","themeswitch.php?theme="+T,!0),xmlhttp.send(),localStorage.setItem("theme",T),console.log("localStorage Theme is: "+T))}}function r(e){elementContainer=document.getElementById(e),elementContainer.addEventListener("click",u,!1)}function u(e){e.target!==e.currentTarget&&(channelLink=e.target.getAttribute("href"),t(S,"js-fx"),g(channelLink),e.preventDefault()),e.stopPropagation()}function g(o){if(""===o){var l=localStorage.getItem("channel");if(null!==l)var o=l}document.getElementById(x).classList.remove("js-hidden"),renderFile="render-feeds.php",xmlhttp=new XMLHttpRequest,xmlhttp.open("GET",renderFile+o,!0),xmlhttp.send(),overlayContainer=document.getElementById("application-overlay"),e(overlayContainer,"js-hidden"),v("content"),xmlhttp.onreadystatechange=function(){4===xmlhttp.readyState&&xmlhttp.readyState&&(outputContainer=document.getElementById("content"),outputContainer.innerHTML=xmlhttp.response,document.getElementById(x).classList.add("js-hidden"),t(elementToFix,"js-fixed"),document.getElementById("application-overlay").classList.remove("js-visible"),n(0,0),localStorage.setItem("channel",o),lastSavedItemTs=localStorage.getItem("latestItemTs"),latestItemTs=h(),p(latestItemTs,lastSavedItemTs),y(j))}}function h(){return latestItemTs=o(j,"data-ts"),latestItemTs}function p(e,t){if(lastSavedItemTsId="#ts-"+t,t&&e>t)updatedCount=o(lastSavedItemTsId,"data-count"),I(updatedCount),f(lastSavedItemTsId);else{document.getElementById("application-header").clientHeight;n(0,localStorage.getItem("offsetTop")),localStorage.setItem("offsetTop",0)}localStorage.setItem("latestItemTs",e)}function f(e){var t=document.querySelector(e).offsetTop,o=document.getElementById("application-header").clientHeight;n(0,t-o)}function y(e){var t=document.querySelectorAll(e);for(i=0;i<t.length;i++)t[i].onclick=function(e){localStorage.setItem("offsetTop",window.pageYOffset)}}function I(e){badge="#unread-items",badgeValue="#unread-items__count",e>0?(document.querySelector(badgeValue).innerText=e,document.querySelector(badge).classList.remove("js-hidden"),document.querySelector(badge).classList.add("js-show")):document.querySelector(badge).classList.add("js-hide")}function v(o){elementToFix=document.getElementById(o),scrollY=window.pageYOffset,elementToFix.classList.contains("js-fixed")?(t(elementToFix,"js-fixed"),elementToFix.style.top="",n(0,scrollYMem)):(e(elementToFix,"js-fixed"),elementToFix.style.top="-"+scrollY+"px",scrollYMem=scrollY)}var T="light",E="dark",x="application-loading",S=document.getElementsByTagName("body")[0],j="#feed-items li",B=localStorage.getItem("theme"),L=document.getElementsByTagName("html")[0];null!==B&&(t(L,T),t(L,E),e(L,B),B===T&&(document.getElementById("theme-switcher").checked=!1),B===E&&(document.getElementById("theme-switcher").checked=!0)),l(),g(""),c("application-header","content","margin-top"),m("theme-switcher"),a("js-overlay-toggle"),d("application-overlay"),r("channels")});